---
/* src/components/Header.astro */

/**
 * Services — simplified, visual, and easier to scan.
 * Accent colour avoided on dark backgrounds.
 */

const services = [
  {
    name: 'Mission Control',
    href: '/mission-control',
    desc: 'Strategy, direction and stakeholder clarity.',
    tag: 'Strategy',
  },
  {
    name: 'Design Ignited',
    href: '/design-ignited',
    desc: 'UX, UI and experience that makes sense.',
    tag: 'Design',
  },
  {
    name: 'LaunchPad',
    href: '/launchpad',
    desc: 'Build and launch something real, quickly.',
    tag: 'Delivery',
  },
  {
    name: 'Work Unblocked',
    href: '/work-unblocked',
    desc: 'Get projects and teams moving again.',
    tag: 'Acceleration',
  },
  {
    name: 'Engine Room',
    href: '/engine-room',
    desc: 'Optimise, measure and keep improving.',
    tag: 'Growth',
  },
];

const differenceCols = [
  {
    title: 'The Reignite Edge',
    items: [
      {
        name: 'Outcomes First',
        href: '/outcomes-first',
        desc: 'We measure success by shipped value, not slides.',
      },
      {
        name: 'Hands-On Delivery',
        href: '/hands-on-delivery',
        desc: 'We don’t just advise — we execute.',
      },
      {
        name: 'Jargon-Free',
        href: '/jargon-free',
        desc: 'Straightforward, transparent communication.',
      },
    ],
  },
  {
    title: 'Focus & Clarity',
    items: [
      {
        name: 'Who We Serve',
        href: '/who-we-serve',
        desc: 'UK teams with ambition, pace, and complexity.',
      },
      {
        name: 'Our Difference',
        href: '/our-difference',
        desc: 'Why we exist and how we work.',
      },
      {
        name: 'Meet the Founder',
        href: '/meet-the-founder',
        desc: 'Product/delivery background, Yorkshire-based.',
      },
    ],
  },
];
---
<header class="sticky top-0 z-50 bg-surface/95 backdrop-blur border-b border-ink/5 shadow-sm">
  <div class="container-reignite flex justify-between items-center h-20 gap-6">
    <!-- BRAND -->
    <a href="/" class="group flex items-center gap-4" aria-label="Reignite Solutions home">
      <img
        src="/assets/brand/logo-web.png"
        alt="Reignite Solutions logo"
        class="h-14 w-14 object-contain rounded-md"
        loading="eager"
      />
      <div class="leading-tight">
        <span class="block font-display text-lg md:text-xl font-bold text-ink tracking-tight">
          Reignite Solutions
        </span>
        <span class="block text-sm md:text-base text-ink/70">
          Clarity. Momentum. Results.
        </span>
      </div>
    </a>

    <!-- DESKTOP NAV -->
    <nav class="hidden md:flex items-center gap-6" aria-label="Primary navigation">
      <!-- SERVICES -->
      <div class="relative nav-dropdown-wrapper" data-dropdown>
        <button
          class="flex items-center gap-2 text-base md:text-lg font-medium text-ink hover:text-accent transition"
          type="button"
          data-dropdown-trigger
          aria-expanded="false"
          aria-haspopup="true"
        >
          What We Do
          <svg
            class="w-4 h-4 transition-transform duration-200"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            aria-hidden="true"
          >
            <title>Open services menu</title>
            <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
        </button>

        <div
          class="nav-dropdown absolute left-1/2 -translate-x-1/2 top-full mt-3 w-[740px]
                 bg-surface border border-ink/10 rounded-xl shadow-2xl p-6 z-40 backdrop-blur"
          data-dropdown-panel
        >
          <div class="grid grid-cols-[1.2fr,0.8fr] gap-6">
            <!-- services list -->
            <div class="grid grid-cols-2 gap-4">
              {services.map((service) => (
                <a
                  href={service.href}
                  class="group/item rounded-lg border border-transparent hover:border-accent/30 bg-white/40 hover:bg-white/80 transition p-3 flex flex-col gap-1"
                >
                  <span
                    class="inline-flex items-center gap-2 text-[10px] uppercase tracking-[0.22em] text-ink/60 bg-ink/5 px-2 py-0.5 rounded-full w-fit"
                  >
                    {service.tag}
                  </span>
                  <span class="block text-sm font-semibold text-ink group-hover/item:text-accent">
                    {service.name}
                  </span>
                  <span class="block text-xs text-ink/60 leading-snug">
                    {service.desc}
                  </span>
                </a>
              ))}
            </div>

            <!-- right-hand card -->
            <div class="bg-ink rounded-lg p-5 flex flex-col justify-between h-full text-white">
              <div class="space-y-2">
                <p class="text-xs uppercase tracking-[0.25em] text-white/50">Need something else?</p>
                <h4 class="text-lg font-display font-semibold">
                  Let’s talk through your challenge.
                </h4>
                <p class="text-sm text-white/70">
                  Not every problem fits in a box — tell us what’s blocking you and we’ll design the right approach.
                </p>
              </div>
              <a
                href="/contact"
                class="mt-4 inline-flex items-center justify-center gap-2 px-4 py-2 rounded-md bg-white text-ink text-sm font-semibold hover:bg-accent hover:text-white transition shadow-md hover:shadow-lg uppercase tracking-wide"
              >
                Contact us
              </a>
            </div>
          </div>

          <a
            href="/services"
            class="block text-center pt-4 mt-5 border-t border-ink/5 text-sm font-semibold text-ink hover:text-accent"
          >
            View all services &raquo;
          </a>
        </div>
      </div>

      <!-- OUR DIFFERENCE -->
      <div class="relative nav-dropdown-wrapper" data-dropdown>
        <button
          class="flex items-center gap-2 text-base md:text-lg font-medium text-ink hover:text-accent transition"
          type="button"
          data-dropdown-trigger
          aria-expanded="false"
          aria-haspopup="true"
        >
          Our Difference
          <svg
            class="w-4 h-4 transition-transform duration-200"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            aria-hidden="true"
          >
            <title>Open our difference menu</title>
            <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
        </button>

        <div
          class="nav-dropdown absolute left-1/2 -translate-x-1/2 top-full mt-3 w-[520px]
                 bg-surface border border-ink/10 rounded-xl shadow-2xl p-8 z-40"
          data-dropdown-panel
        >
          <div class="grid grid-cols-2 gap-6">
            {differenceCols.map((col) => (
              <div>
                <h4
                  class="text-xs font-bold uppercase text-accent mb-4 tracking-[0.18em] border-b border-accent/20 pb-2"
                >
                  {col.title}
                </h4>
                <ul class="space-y-3">
                  {col.items.map((item) => (
                    <li>
                      <a href={item.href} class="block group/item">
                        <span class="block text-base font-semibold text-ink group-hover/item:text-accent">
                          {item.name}
                        </span>
                        <span class="block text-xs text-ink/50 mt-1 leading-snug">
                          {item.desc}
                        </span>
                      </a>
                    </li>
                  ))}
                </ul>
              </div>
            ))}
          </div>
          <a
            href="/our-difference"
            class="block text-center pt-4 mt-6 border-t border-ink/5 text-sm font-semibold text-ink hover:text-accent"
          >
            Explore our approach &raquo;
          </a>
        </div>
      </div>

      <!-- CTA -->
      <a
        href="/contact"
        class="flex items-center gap-2 px-5 py-2 rounded-lg text-white font-bold tracking-wide uppercase
               bg-accent hover:bg-black transition shadow-md hover:shadow-lg text-sm md:text-base"
      >
        Contact us
      </a>
    </nav>

    <!-- MOBILE NAV -->
    <details class="md:hidden relative">
      <summary class="list-none cursor-pointer rounded p-2 hover:bg-ink/5" aria-label="Open navigation">
        <div class="w-6 h-0.5 bg-ink mb-1"></div>
        <div class="w-6 h-0.5 bg-ink mb-1"></div>
        <div class="w-6 h-0.5 bg-ink"></div>
      </summary>
      <div
        class="absolute right-0 mt-3 w-72 bg-surface border border-ink/5 rounded-lg shadow-lg p-4 space-y-4 z-50"
      >
        <div>
          <p class="text-xs uppercase tracking-wide text-ink/50 mb-2">What We Do</p>
          <div class="pl-2 border-l border-ink/10 space-y-1">
            {services.map((service) => (
              <a href={service.href} class="block text-sm text-ink/80 hover:text-accent">
                {service.name}
              </a>
            ))}
          </div>
        </div>
        <div>
          <p class="text-xs uppercase tracking-wide text-ink/50 mb-2">Our Difference</p>
          <div class="pl-2 border-l border-ink/10 space-y-1">
            {differenceCols.flatMap((col) =>
              col.items.map((item) => (
                <a href={item.href} class="block text-sm text-ink/80 hover:text-accent">
                  {item.name}
                </a>
              ))
            )}
          </div>
        </div>
        <a
          href="/contact"
          class="block text-center mt-2 px-4 py-2 bg-accent text-white rounded-md font-semibold uppercase tracking-wide"
        >
          Contact us
        </a>
      </div>
    </details>
  </div>

  <!-- Dropdown controller -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const dropdowns = document.querySelectorAll('[data-dropdown]');

      dropdowns.forEach((wrapper) => {
        const trigger = wrapper.querySelector('[data-dropdown-trigger]');
        const panel = wrapper.querySelector('[data-dropdown-panel]');
        let closeTimeout = null;

        const open = () => {
          clearTimeout(closeTimeout);
          wrapper.classList.add('is-open');
          trigger?.setAttribute('aria-expanded', 'true');
        };

        const close = () => {
          closeTimeout = setTimeout(() => {
            wrapper.classList.remove('is-open');
            trigger?.setAttribute('aria-expanded', 'false');
          }, 150);
        };

        trigger?.addEventListener('mouseenter', open);
        panel?.addEventListener('mouseenter', open);

        trigger?.addEventListener('mouseleave', close);
        panel?.addEventListener('mouseleave', close);

        trigger?.addEventListener('focus', open);
        panel?.addEventListener('focusin', open);
        trigger?.addEventListener('blur', close);
        panel?.addEventListener('focusout', close);
      });
    });
  </script>
</header>
